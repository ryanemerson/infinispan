<project name="documentation" default="create-report">

	<target name="copy-files">
		<property name="src.dir" value="${basedir}/.." />
		<property name="work.dir" value="${project.build.directory}/generated/${infinispan.base.version}/report/tmp" />
		<property name="search.string" value="DescriptionDocumentation" />
		<property name="dest.dir" value="${project.build.directory}/generated/${infinispan.base.version}/report" />
		<delete dir="${work.dir}" />
		<mkdir dir="${work.dir}" />
		<copy todir="${work.dir}" failonerror="false" >
			<fileset dir="${src.dir}" defaultexcludes="true">
				<include name="**/*.xml" />
				<exclude name="**/descriptionreport.xml" />
				<contains text="${search.string}" casesensitive="yes" />
			</fileset>
		</copy>
		<copy todir="${dest.dir}" failonerror="false" file="${basedir}/src/main/resources/FinalReport.html" />
	</target>
	<target name="create-report" depends="copy-files">
		<property name="temp.dir" value="${project.build.directory}/generated/${infinispan.base.version}/logs/tmp" />
		<property name="dest.dir" value="${project.build.directory}/generated/${infinispan.base.version}/logs" />
		<xslt style="logging-report2.xsl" basedir="${temp.dir}" destdir="${temp.dir}" extension=".html" includes="**/*.xml">
		<param name="directory" expression="${temp.dir}"/>
		</xslt>
		<concat append="true" destfile="${dest.dir}/Report.html">
			<fileset dir="${temp.dir}" defaultexcludes="true">
				<include name="**/*.html" />
			</fileset>
		</concat>
		<delete dir="${temp.dir}"/>
	</target>
</project>
